<%- include("../partials/html-head") %>
  <%- include("../partials/nav") %>

  <h2>Reviews</h2>
  <form id="add-review-form" action="/profiles/<%= recipe._id %>/reviews" method="POST">
    <label for="content-textarea">Review:</label>
    <textarea name="content" id="content-textarea"></textarea>
    <label for="rating-select">Rating:</label>
    <select name="rating" id="rating-select">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5" selected>5</option>
    </select>
    <button type="submit">Add Review</button>
  </form>
  <% if (review.reviews.length) { %>
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Review</th>
          <th>Rating</th>
        </tr>
      </thead>
      <tbody>
        <% let total=0 %>
          <% review.reviews.forEach(function(review){ %>
            <% total +=review.rating %>
              <tr>
                <td>
                  <%= review.createdAt.toLocaleDateString() %>
                </td>
                <td>
                  <%= review.content %>
                </td>
                <td>
                  <%= review.rating %>
                </td>
              </tr>
              <% }) %>
                <tr>
                  <td colspan="2"></td>
                  <td>
                    <strong>
                      <%= averageReviewScore %>
                    </strong>
                  </td>
                </tr>
      </tbody>
    </table>
    <% } else { %>
      <h3>No Reviews Yet</h3>
      <% } %>